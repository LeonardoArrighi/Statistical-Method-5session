---
title: "SMDS Homework - Block 5"
author: "E. Fabrici, V. Plesco, L. Arrighi | Group 'D'"
date: "22th June 2020"
output:
  html_document:
    toc: yes
  beamer_presentation:
    highlight: tango
  include: null
  ioslides_presentation:
    highlight: tango
  pdf_document:
    highlight: tango
    keep_tex: yes
    toc: yes
  slide_level: 2
  slidy_presentation:
    fig.height: 3
    fig.width: 4
    highlight: tango
header-includes:
- \usepackage{color}
- \usepackage{graphicx}
- \usepackage{grffile}
- \definecolor{Purple}{HTML}{911146}
- \definecolor{Orange}{HTML}{CF4A30}
- \setbeamercolor{alerted text}{fg=Orange}
- \setbeamercolor{frametitle}{bg=Purple}
institute: University of Trieste, SISSA, ICTP, University of Udine
graphics: yes
fontsize: 10pt
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.align = 'center', warning=FALSE, message=FALSE, fig.asp=0.625, dev='png', global.par = TRUE, dev.args=list(pointsize=10), fig.path = 'figs/')
library(MASS)
```

```{r setup, include=FALSE}
library(knitr)
local({
  hook_plot = knit_hooks$get('plot')
  knit_hooks$set(plot = function(x, options) {
    paste0('\n\n----\n\n', hook_plot(x, options))
  })
})
```

# Homeworks {.tabset}

## Used libraries {.tabset}

```{r}
library(ggplot2)
library(lattice)
library(DAAG)
```



## DAAG EXERCISES {.tabset}

### Chapter 7 {.tabset}

#### Exercise 2

Use `anova()` to compare the two models:
```
roller.lm <- lm(depression~weight, data=roller)
roller.lm2 <- lm(depression~weight+I(weight^2), data=roller)
```
Is there any justification for including the squared term?

##### Solution

```{r}
roller.lm <- lm(depression~weight, data=roller)
roller.lm2 <- lm(depression~weight+I(weight^2), data=roller)
anova(roller.lm, roller.lm2) #P-f test- very high
```


##### Observations

From the $F$ test it is possible to notice that the probability $Pr(F\geq f_{obs})$ is quite high, assuming the null hypothesis $H_0:\beta_{weight^2} = 0$ is true. Thus, as there is no significant difference between the two models we can keep the simpler one, namely `roller.lm`. However let's see the diagnostic plots.

```{r}
par(mfrow=c(2,2))
plot(roller.lm)
par(mfrow=c(2,2))
plot(roller.lm2)
```
In both models it is possible to observe that there is a problematic observation, the one labeled with 10, 5 and 7. The plots `Residuals vs Leverage`, `Scale-Location` and `Normal Q-Q` show clearly that the aforementioned points are suspect. Let's remove it and refit the models.
```{r}
remove <- c("5", "7", "10")
roller_mod <- roller[!rownames(roller) %in% remove,]
roller.lm <- lm(depression~weight, data=roller_mod)
roller.lm2 <- lm(depression~weight+I(weight^2), data=roller_mod)
anova(roller.lm, roller.lm2)
```
Now the p-value is even higher than before. This means that the points analysed were not problematic in terms of comparison of the two models. We confirm than our initial choice that there is statistical reason to prefer one model to the other.
##### Conclusion

Conclusions.

#### Exercise x

Text here.

##### Solution

```{r Test_ex, code = readLines("src/Test_ex.R"), echo=TRUE}
```

##### Observations

Observations.

##### Conclusion

Conclusions.



## CASI EXERCISES {.tabset}

### Chapter x {.tabset}

#### Exercise x

Text here.

##### Solution

```{r Test_ex, code = readLines("src/Test_ex.R"), echo=TRUE}
```

##### Observations

Observations.

##### Conclusion

Conclusions.



## CS EXERCISES {.tabset}

### Chapter x {.tabset}

#### Exercise x

Text here.

##### Solution

```{r Test_ex, code = readLines("src/Test_ex.R"), echo=TRUE}
```

##### Observations

Observations.

##### Conclusion

Conclusions.

